-- Bảng Sinh Viên
CREATE TABLE SinhVien (
    MaSV INT PRIMARY KEY IDENTITY(1,1),
    TenDangNhap NVARCHAR(50) UNIQUE NOT NULL,
    HoTen NVARCHAR(100) NOT NULL,
    NgaySinh DATE NOT NULL,
    GioiTinh NVARCHAR(10)
    Email NVARCHAR(100) UNIQUE NOT NULL,
    MatKhau NVARCHAR(255) NOT NULL,
    SDT NVARCHAR(15) UNIQUE NOT NULL,
    DiaChi NVARCHAR(255) NOT NULL
);

-- Bảng Giảng Viên
CREATE TABLE GiangVien (
    MaGV INT PRIMARY KEY IDENTITY(1,1),
    TenDangNhap NVARCHAR(50) UNIQUE NOT NULL,
    HoTen NVARCHAR(100) NOT NULL,
    Email NVARCHAR(100) UNIQUE NOT NULL,
    MatKhau NVARCHAR(255) NOT NULL,
    SDT NVARCHAR(15) UNIQUE NOT NULL,
    DiaChi NVARCHAR(255) NOT NULL
);

-- Bảng Quản trị viên (Admin)
CREATE TABLE Admin (
    MaAdmin INT PRIMARY KEY IDENTITY(1,1),
    TenDangNhap NVARCHAR(50) UNIQUE NOT NULL,
    HoTen NVARCHAR(100) NOT NULL,
    Email NVARCHAR(100) UNIQUE NOT NULL,
    MatKhau NVARCHAR(255) NOT NULL,
    SDT NVARCHAR(15) UNIQUE NOT NULL
);

-- Bảng Môn Học
CREATE TABLE MonHoc (
    MaMH INT PRIMARY KEY IDENTITY(1,1),
    TenMH NVARCHAR(100) UNIQUE NOT NULL,
    SoTinChi INT NOT NULL CHECK (SoTinChi > 0)
);

-- Bảng Lớp Tín Chỉ
CREATE TABLE LopTinChi (
    MaLTC INT PRIMARY KEY IDENTITY(1,1),
    MaMH INT FOREIGN KEY REFERENCES MonHoc(MaMH) ON DELETE CASCADE,
    MaGV INT FOREIGN KEY REFERENCES GiangVien(MaGV) ON DELETE SET NULL,
    HocKy INT CHECK (HocKy BETWEEN 1 AND 3),
    NamHoc NVARCHAR(9) NOT NULL,  -- Ví dụ: "2024-2025"
    NgayBatDau DATE NOT NULL,
    NgayKetThuc DATE NOT NULL,
    BuoiHoc NVARCHAR(10)
);


-- Bảng Đăng Ký (Sinh viên đăng ký lớp tín chỉ)
CREATE TABLE DangKy (
    MaDK INT PRIMARY KEY IDENTITY(1,1),
    MaSV INT NOT NULL,
    MaLTC INT NOT NULL,
    FOREIGN KEY (MaSV) REFERENCES SinhVien(MaSV),
    FOREIGN KEY (MaLTC) REFERENCES LopTinChi(MaLTC)
);
